@{
    ViewData["Title"] = "Guide - Reservations";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<partial name="~/Views/Shared/Breadcrumb.cshtml">
<partial name="~/Views/Shared/TourGuide/UserProfileWrapper.cshtml">

<div class="pt-30 pb-50">

    <div class="container">

        <div class="row">

            <div class="col-xs-12 mt-20">

                <div class="dashboard-wrapper">

                    <h4 class="section-title">Sells</h4>

                    <table id="tblData" class="table table-striped table-bordered " style="width:100%;text-align:center">
                        <thead class="thead-dark">
                            <tr class="table-info">
                                <th>Trip Name</th>
                                <th>Tourist Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Booking Date</th>
                                <th>Booking Status</th>
                                <th>Process</th>
                            </tr>
                        </thead>

                    </table>

                </div>

            </div>

        </div>

    </div>

</div>



@section Scripts{

    <script>
        $(".table-info th").css("text-align", "center")

        dataTable = $('#tblData').DataTable({
            "ajax": {
                "type": "GET",
                "url": "/TourGuide/GuideDashboardToursReservation/TourSells"
            },
            "columns": [
                { "data": "tripTitle", "width": "15%" },
                { "data": "userFirstName", "width": "15%" },
                { "data": "email", "width": "15%" },
                { "data": "phoneNumber", "width": "15%" },
                { "data": "bookingDate", "width": "15%" },
                { "data": "bookingStatus", "width": "40%" },
                {
                    "data": { "bookingId":"bookingId", "bookingStatus":"bookingStatus"},
                    "render": function (data) {
                        if (data.bookingStatus == "Confirmation") {
                            return `
                                <div class="text-center">
                                    <a onclick=tripCompleted("/TourGuide/GuideDashboardToursReservation/TripCompleted?bookingId=${data.bookingId}") class="btn btn-primary" style="cursor: pointer">
                                        <i class="fa fa-clock-o" aria-hidden="true"></i> Completed
                                    </a>
                                </div>
                               `
                        } else {
                            return `
                                <div class="text-center">
                                    <a class="btn btn-success">
                                        <i class="fa fa-check" aria-hidden="true"></i> Completed
                                    </a>
                                </div>
                               `
                        }
                    }, "width": "40%"
                }
            ]
        });

        function tripCompleted(url) {
            $.ajax({
                type: "POST",
                url: url,
                success: function (data) {
                    if (data.success) {
                        dataTable.ajax.reload();
                    }

                    else
                        alert(data.message);
                }
            })
        }

    </script>

}